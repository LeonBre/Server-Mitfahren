<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test</title>
    <meta name="author" content="Leon Johann Brettin">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="css/master.css" media="screen" title="no title" charset="utf-8">
  </head>
<body>

  <input id="inputFileToLoad" type="file" onchange="test();" />
  <div id="imgTest"></div>

  </body>




  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
  <script src="resources/CryptoJS/rollups/sha512.js"></script>
  <script src="resources/jquery-cookie/js.cookie.js"></script>

  <script type="text/javascript">

  function test(){
    console.log(encodeImageFileAsURL());
  }

  function convertFileToDataURLviaFileReader(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.responseType = 'blob';
    xhr.onload = function() {
      var reader = new FileReader();
      reader.onloadend = function() {
        callback(reader.result);
      }
      reader.readAsDataURL(xhr.response);
    };
    xhr.open('GET', url);
    xhr.send();
  }

  








  function encodeImageFileAsURL() {
    var workpls;

    var filesSelected = document.getElementById("inputFileToLoad").files;
    if (filesSelected.length > 0) {
      var fileToLoad = filesSelected[0];

      var fileReader = new FileReader();

      fileReader.onload = function(fileLoadedEvent) {
        var srcData = fileLoadedEvent.target.result; // <--- data: base64

        var newImage = document.createElement('img');
        newImage.src = srcData;

        //----------------------------
        var data = {
          data: newImage.outerHTML
        }
        data = JSON.stringify(data)
        $.ajax({
          type: 'POST',
          url: destinationURL + '/Server-Mitfahren/apiv1/testFileUpload',
          contentType: "application/json",
          data: data,
          success: function(succesPicture) {
            console.log("success");
            document.getElementById("imgTest").innerHTML = succesPicture.data;
          },
          error: function(xhr, status, error) {
            var err = eval("(" + xhr.responseText + ")");
            alert(err.Message);
          }
        });
        //------------------------------
      }
      fileReader.readAsDataURL(fileToLoad);
    }
    return workpls;
  }
  </script>

  <script type="text/javascript" src="js/navbar.js"></script>
</html>
